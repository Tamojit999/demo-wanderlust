<% layout('./layouts/boilerplate') -%>

    <body>

        <div id="filter">

            

            <div class="filter">
                <a class="nav-link" href="/listings/category?name=pool">
                    <div><i class="fa-solid fa-person-swimming"></i></div>
                    <p>Pools</p>
                </a>

            </div>
            <div class="filter">
                <a class="nav-link" href="/listings/category?name=mountain">
                    <div><i class="fa-solid fa-mountain-sun"></i></div>
                    <p>Mountains</p>
                </a>

            </div>

            <div class="filter">
                <a class="nav-link" href="/listings/category?name=farm">
                    <div><i class="fa-solid fa-tractor"></i></div>
                    <p>Farms</p>
            </div></a>
            <div class="filter">
                <a class="nav-link" href="/listings/category?name=city">
                    <div><i class="fa-solid fa-city"></i></div>
                    <p>Cities</p>
            </div></a>
            <div class="filter">
                <a class="nav-link" href="/listings/category?name=beach">
                    <div><i class="fa-solid fa-umbrella-beach"></i></div>
                    <p>Beaches</p>
            </div></a>
            <div class="filter">
                <a class="nav-link" href="/listings/category?name=forest">
                    <div><i class="fa-solid fa-tree"></i></div>
                    <p>Forest</p>
            </div></a>



        </div>
        <% if(alllistings.length>0){ %>
            <div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1">

                <% for (let list of alllistings) { %>
                    <a class="card-link" href="/listings/<%= list._id %>">
                        <div class="card col listing-card">
                            <img src="<%= list.image && list.image.url ? list.image.url : '/images/default.jpg' %>"
                                class="card-img-top" alt="listing" style="height: 20rem">

                            <div class="card-img-overlay">.</div>

                            <div class="card-body">
                                <p class="card-text mt-2">
                                    <b>
                                        <%= list.title || "Untitled" %>
                                    </b><br>

                                    <span>&#8377;
                                        <%= list.price ? Number(list.price).toLocaleString("en-IN") : "N/A" %>
                                    </span>/night
                                    <br>

                                    <span>
                                         <i class="fa-solid fa-map-marker-alt"></i>
                                        <%= list.location || "Unknown location" %>,
                                            <%= list.country || "Unknown country" %>
                                    </span>
                                </p>
                            </div>

                        </div>
                    </a>
                    <% } %>
            </div>

            <nav class="pagination-nav">
                <ul class="pagination">
                    <% if(currentPage>1){ %>

                        <li class="page-item">
                            <a href="/listings?page=<%= currentPage - 1 %>" class="page-link">‹ Prev</a>
                        </li>

                        <% } else { %>
                            <li class="page-item disabled"><span class="page-link">‹ Prev</span></li>
                            <% } %>
                                <% for (let i=1; i <=totalPages; i++) { %>
                                    <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                                        <a href="/listings?page=<%= i %>" class="page-link">
                                            <%= i %>
                                        </a>
                                    </li>
                                    <% } %>


                                        <% if (currentPage < totalPages) { %>
                                            <li class="page-item">
                                                <a href="/listings?page=<%= currentPage + 1 %>" class="page-link">Next
                                                    ›</a>
                                            </li>
                                            <% } else { %>
                                                <li class="page-item disabled"><span class="page-link">Next ›</span>
                                                </li>
                                                <% } %>
                </ul>
            </nav>
            <% }else{%>
                <div
                    style="display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center;">
                    
                    <h2 style="color:#333; font-family:Arial, sans-serif; margin-top:1rem;">No Listing Found</h2>
                    <p style="color:#666; font-family:Arial, sans-serif;">Try adjusting your search or check back later.
                    </p>
                </div>

                <% } %>
    </body>